
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../spark-ddl/">
      
      
        <link rel="next" href="../spark-queries/">
      
      <link rel="icon" href="/assets/images/favicon-96x96.png">
      <meta name="generator" content="mkdocs-1.5.2, mkdocs-material-9.1.21">
    
    
      
        <title>Procedures - Apache Iceberg</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.eebd395e.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#spark-procedures" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Apache Iceberg" class="md-header__button md-logo" aria-label="Apache Iceberg" data-md-component="logo">
      
  <img src="/assets/images/iceberg-logo-icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Apache Iceberg
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Procedures
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../hive-quickstart/" class="md-tabs__link">
        Quickstart
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    

  
  
  
    <li class="md-tabs__item">
      <a href="../../docs/latest/" class="md-tabs__link md-tabs__link--active">
        Docs
      </a>
    </li>
  

  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../releases/" class="md-tabs__link">
      Releases
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../roadmap/" class="md-tabs__link">
      Roadmap
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../blogs/" class="md-tabs__link">
      Blogs
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../talks/" class="md-tabs__link">
      Talks
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../vendors/" class="md-tabs__link">
      Vendors
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../community/" class="md-tabs__link">
        Project
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../ASF/" class="md-tabs__link">
        ASF
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Apache Iceberg" class="md-nav__button md-logo" aria-label="Apache Iceberg" data-md-component="logo">
      
  <img src="/assets/images/iceberg-logo-icon.png" alt="logo">

    </a>
    Apache Iceberg
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Quickstart
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Quickstart
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../hive-quickstart/" class="md-nav__link">
        Hive
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../spark-quickstart/" class="md-nav__link">
        Spark
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Docs
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Docs
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" >
      
      
      
        <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
          latest
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1">
          <span class="md-nav__icon md-icon"></span>
          latest
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_1_2" id="__nav_2_1_2_label" tabindex="0">
          Tables
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1_2">
          <span class="md-nav__icon md-icon"></span>
          Tables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/branching/" class="md-nav__link">
        Branching and Tagging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/evolution/" class="md-nav__link">
        Evolution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/maintenance/" class="md-nav__link">
        Maintenance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/partitioning/" class="md-nav__link">
        Partitioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/performance/" class="md-nav__link">
        Performance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/reliability/" class="md-nav__link">
        Reliability
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/schemas/" class="md-nav__link">
        Schemas
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_3" >
      
      
      
        <label class="md-nav__link" for="__nav_2_1_3" id="__nav_2_1_3_label" tabindex="0">
          Spark
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1_3">
          <span class="md-nav__icon md-icon"></span>
          Spark
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/spark-getting-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/spark-configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/spark-ddl/" class="md-nav__link">
        DDL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/spark-procedures/" class="md-nav__link">
        Procedures
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/spark-queries/" class="md-nav__link">
        Queries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/spark-structured-streaming/" class="md-nav__link">
        Structured Streaming
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/spark-writes/" class="md-nav__link">
        Writes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_4" >
      
      
      
        <label class="md-nav__link" for="__nav_2_1_4" id="__nav_2_1_4_label" tabindex="0">
          Flink
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1_4">
          <span class="md-nav__icon md-icon"></span>
          Flink
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/flink/" class="md-nav__link">
        Flink Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/flink-connector/" class="md-nav__link">
        Flink Connector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/flink-ddl/" class="md-nav__link">
        Flink DDL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/flink-queries/" class="md-nav__link">
        Flink Queries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/flink-writes/" class="md-nav__link">
        Flink Writes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/flink-actions/" class="md-nav__link">
        Flink Actions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/flink-configuration/" class="md-nav__link">
        Flink Configuration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/hive/" class="md-nav__link">
        Hive
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://trino.io/docs/current/connector/iceberg.html" class="md-nav__link">
        Trino
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://clickhouse.com/docs/en/engines/table-engines/integrations/iceberg" class="md-nav__link">
        Clickhouse
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://prestodb.io/docs/current/connector/iceberg.html" class="md-nav__link">
        Presto
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.dremio.com/data-formats/apache-iceberg/" class="md-nav__link">
        Dremio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.starrocks.io/en-us/latest/data_source/catalog/iceberg_catalog" class="md-nav__link">
        Starrocks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.aws.amazon.com/athena/latest/ug/querying-iceberg.html" class="md-nav__link">
        Amazon Athena
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-iceberg-use-cluster.html" class="md-nav__link">
        Amazon EMR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://impala.apache.org/docs/build/html/topics/impala_iceberg.html" class="md-nav__link">
        Impala
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://doris.apache.org/docs/dev/lakehouse/multi-catalog/iceberg" class="md-nav__link">
        Doris
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_15" >
      
      
      
        <label class="md-nav__link" for="__nav_2_1_15" id="__nav_2_1_15_label" tabindex="0">
          Integrations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_15_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1_15">
          <span class="md-nav__icon md-icon"></span>
          Integrations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/aws/" class="md-nav__link">
        AWS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/dell/" class="md-nav__link">
        Dell
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/jdbc/" class="md-nav__link">
        JDBC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/nessie/" class="md-nav__link">
        Nessie
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1_16" >
      
      
      
        <label class="md-nav__link" for="__nav_2_1_16" id="__nav_2_1_16_label" tabindex="0">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_1_16_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_1_16">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/java-api-quickstart/" class="md-nav__link">
        Java Quickstart
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/api/" class="md-nav__link">
        Java API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../docs/latest/custom-catalog/" class="md-nav__link">
        Java Custom Catalog
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://iceberg.apache.org/javadoc/latest/" class="md-nav__link">
        Javadoc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://py.iceberg.apache.org/" class="md-nav__link">
        PyIceberg
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          1.3.1
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          1.3.1
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Introduction
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
          Tables
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2_2">
          <span class="md-nav__icon md-icon"></span>
          Tables
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../branching/" class="md-nav__link">
        Branching and Tagging
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../evolution/" class="md-nav__link">
        Evolution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../maintenance/" class="md-nav__link">
        Maintenance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../partitioning/" class="md-nav__link">
        Partitioning
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../performance/" class="md-nav__link">
        Performance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../reliability/" class="md-nav__link">
        Reliability
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../schemas/" class="md-nav__link">
        Schemas
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_3" checked>
      
      
      
        <label class="md-nav__link" for="__nav_2_2_3" id="__nav_2_2_3_label" tabindex="0">
          Spark
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_3_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_2_2_3">
          <span class="md-nav__icon md-icon"></span>
          Spark
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spark-getting-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spark-configuration/" class="md-nav__link">
        Configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spark-ddl/" class="md-nav__link">
        DDL
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Procedures
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Procedures
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#named-arguments" class="md-nav__link">
    Named arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#positional-arguments" class="md-nav__link">
    Positional arguments
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snapshot-management" class="md-nav__link">
    Snapshot management
  </a>
  
    <nav class="md-nav" aria-label="Snapshot management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rollback_to_snapshot" class="md-nav__link">
    rollback_to_snapshot
  </a>
  
    <nav class="md-nav" aria-label="rollback_to_snapshot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_1" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rollback_to_timestamp" class="md-nav__link">
    rollback_to_timestamp
  </a>
  
    <nav class="md-nav" aria-label="rollback_to_timestamp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_2" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_1" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_current_snapshot" class="md-nav__link">
    set_current_snapshot
  </a>
  
    <nav class="md-nav" aria-label="set_current_snapshot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_3" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_2" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_2" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cherrypick_snapshot" class="md-nav__link">
    cherrypick_snapshot
  </a>
  
    <nav class="md-nav" aria-label="cherrypick_snapshot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_4" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_3" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata-management" class="md-nav__link">
    Metadata management
  </a>
  
    <nav class="md-nav" aria-label="Metadata management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#expire_snapshots" class="md-nav__link">
    expire_snapshots
  </a>
  
    <nav class="md-nav" aria-label="expire_snapshots">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_5" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_4" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_1" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove_orphan_files" class="md-nav__link">
    remove_orphan_files
  </a>
  
    <nav class="md-nav" aria-label="remove_orphan_files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_6" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_5" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_2" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rewrite_data_files" class="md-nav__link">
    rewrite_data_files
  </a>
  
    <nav class="md-nav" aria-label="rewrite_data_files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_7" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_6" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_3" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rewrite_manifests" class="md-nav__link">
    rewrite_manifests
  </a>
  
    <nav class="md-nav" aria-label="rewrite_manifests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_8" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_7" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_4" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#table-migration" class="md-nav__link">
    Table migration
  </a>
  
    <nav class="md-nav" aria-label="Table migration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snapshot" class="md-nav__link">
    snapshot
  </a>
  
    <nav class="md-nav" aria-label="snapshot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_9" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_8" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_5" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migrate" class="md-nav__link">
    migrate
  </a>
  
    <nav class="md-nav" aria-label="migrate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_10" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_9" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_6" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_files" class="md-nav__link">
    add_files
  </a>
  
    <nav class="md-nav" aria-label="add_files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_11" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_10" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_7" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register_table" class="md-nav__link">
    register_table
  </a>
  
    <nav class="md-nav" aria-label="register_table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_12" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_11" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_8" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata-information" class="md-nav__link">
    Metadata information
  </a>
  
    <nav class="md-nav" aria-label="Metadata information">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors_of" class="md-nav__link">
    ancestors_of
  </a>
  
    <nav class="md-nav" aria-label="ancestors_of">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_13" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_12" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_9" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change-data-capture" class="md-nav__link">
    Change Data Capture
  </a>
  
    <nav class="md-nav" aria-label="Change Data Capture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_changelog_view" class="md-nav__link">
    create_changelog_view
  </a>
  
    <nav class="md-nav" aria-label="create_changelog_view">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_14" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_13" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_10" class="md-nav__link">
    Examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#carry-over-rows" class="md-nav__link">
    Carry-over Rows
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prepost-update-images" class="md-nav__link">
    Pre/Post Update Images
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spark-queries/" class="md-nav__link">
        Queries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spark-structured-streaming/" class="md-nav__link">
        Structured Streaming
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../spark-writes/" class="md-nav__link">
        Writes
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_4" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2_4" id="__nav_2_2_4_label" tabindex="0">
          Flink
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2_4">
          <span class="md-nav__icon md-icon"></span>
          Flink
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../flink/" class="md-nav__link">
        Flink Getting Started
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../flink-connector/" class="md-nav__link">
        Flink Connector
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../flink-ddl/" class="md-nav__link">
        Flink DDL
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../flink-queries/" class="md-nav__link">
        Flink Queries
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../flink-writes/" class="md-nav__link">
        Flink Writes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../flink-actions/" class="md-nav__link">
        Flink Actions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../flink-configuration/" class="md-nav__link">
        Flink Configuration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../hive/" class="md-nav__link">
        Hive
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://trino.io/docs/current/connector/iceberg.html" class="md-nav__link">
        Trino
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://clickhouse.com/docs/en/engines/table-engines/integrations/iceberg" class="md-nav__link">
        Clickhouse
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://prestodb.io/docs/current/connector/iceberg.html" class="md-nav__link">
        Presto
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.dremio.com/data-formats/apache-iceberg/" class="md-nav__link">
        Dremio
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.starrocks.io/en-us/latest/data_source/catalog/iceberg_catalog" class="md-nav__link">
        Starrocks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.aws.amazon.com/athena/latest/ug/querying-iceberg.html" class="md-nav__link">
        Amazon Athena
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://docs.aws.amazon.com/emr/latest/ReleaseGuide/emr-iceberg-use-cluster.html" class="md-nav__link">
        Amazon EMR
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://impala.apache.org/docs/build/html/topics/impala_iceberg.html" class="md-nav__link">
        Impala
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://doris.apache.org/docs/dev/lakehouse/multi-catalog/iceberg" class="md-nav__link">
        Doris
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_15" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2_15" id="__nav_2_2_15_label" tabindex="0">
          Integrations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_15_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2_15">
          <span class="md-nav__icon md-icon"></span>
          Integrations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aws/" class="md-nav__link">
        AWS
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dell/" class="md-nav__link">
        Dell
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../jdbc/" class="md-nav__link">
        JDBC
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../nessie/" class="md-nav__link">
        Nessie
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_16" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2_16" id="__nav_2_2_16_label" tabindex="0">
          API
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_16_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2_16">
          <span class="md-nav__icon md-icon"></span>
          API
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../java-api-quickstart/" class="md-nav__link">
        Java Quickstart
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        Java API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../custom-catalog/" class="md-nav__link">
        Java Custom Catalog
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://iceberg.apache.org/javadoc/latest/" class="md-nav__link">
        Javadoc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://py.iceberg.apache.org/" class="md-nav__link">
        PyIceberg
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../releases/" class="md-nav__link">
        Releases
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../roadmap/" class="md-nav__link">
        Roadmap
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../blogs/" class="md-nav__link">
        Blogs
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../talks/" class="md-nav__link">
        Talks
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../vendors/" class="md-nav__link">
        Vendors
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
      
      
      
        <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
          Project
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          Project
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../community/" class="md-nav__link">
        Join
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../spec/" class="md-nav__link">
        Spec
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../view-spec/" class="md-nav__link">
        View spec
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../puffin-spec/" class="md-nav__link">
        Puffin spec
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../multi-engine-support/" class="md-nav__link">
        Multi-engine support
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../how-to-release/" class="md-nav__link">
        How to release
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../terms/" class="md-nav__link">
        Terms
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
      
      
      
        <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
          ASF
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_9">
          <span class="md-nav__icon md-icon"></span>
          ASF
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ASF/" class="md-nav__link">
        ASF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://www.apache.org/foundation/sponsorship.html" class="md-nav__link">
        Sponsorship
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://www.apache.org/events/current-event.html" class="md-nav__link">
        Events
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://www.apache.org/licenses/" class="md-nav__link">
        License
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://www.apache.org/security/" class="md-nav__link">
        Security
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="https://www.apache.org/foundation/thanks.html" class="md-nav__link">
        Sponsors
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#usage" class="md-nav__link">
    Usage
  </a>
  
    <nav class="md-nav" aria-label="Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#named-arguments" class="md-nav__link">
    Named arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#positional-arguments" class="md-nav__link">
    Positional arguments
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#snapshot-management" class="md-nav__link">
    Snapshot management
  </a>
  
    <nav class="md-nav" aria-label="Snapshot management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#rollback_to_snapshot" class="md-nav__link">
    rollback_to_snapshot
  </a>
  
    <nav class="md-nav" aria-label="rollback_to_snapshot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_1" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rollback_to_timestamp" class="md-nav__link">
    rollback_to_timestamp
  </a>
  
    <nav class="md-nav" aria-label="rollback_to_timestamp">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_2" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_1" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_1" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set_current_snapshot" class="md-nav__link">
    set_current_snapshot
  </a>
  
    <nav class="md-nav" aria-label="set_current_snapshot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_3" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_2" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example_2" class="md-nav__link">
    Example
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cherrypick_snapshot" class="md-nav__link">
    cherrypick_snapshot
  </a>
  
    <nav class="md-nav" aria-label="cherrypick_snapshot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_4" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_3" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata-management" class="md-nav__link">
    Metadata management
  </a>
  
    <nav class="md-nav" aria-label="Metadata management">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#expire_snapshots" class="md-nav__link">
    expire_snapshots
  </a>
  
    <nav class="md-nav" aria-label="expire_snapshots">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_5" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_4" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_1" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove_orphan_files" class="md-nav__link">
    remove_orphan_files
  </a>
  
    <nav class="md-nav" aria-label="remove_orphan_files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_6" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_5" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_2" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rewrite_data_files" class="md-nav__link">
    rewrite_data_files
  </a>
  
    <nav class="md-nav" aria-label="rewrite_data_files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_7" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_6" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_3" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rewrite_manifests" class="md-nav__link">
    rewrite_manifests
  </a>
  
    <nav class="md-nav" aria-label="rewrite_manifests">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_8" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_7" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_4" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#table-migration" class="md-nav__link">
    Table migration
  </a>
  
    <nav class="md-nav" aria-label="Table migration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#snapshot" class="md-nav__link">
    snapshot
  </a>
  
    <nav class="md-nav" aria-label="snapshot">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_9" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_8" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_5" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#migrate" class="md-nav__link">
    migrate
  </a>
  
    <nav class="md-nav" aria-label="migrate">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_10" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_9" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_6" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add_files" class="md-nav__link">
    add_files
  </a>
  
    <nav class="md-nav" aria-label="add_files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_11" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_10" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_7" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#register_table" class="md-nav__link">
    register_table
  </a>
  
    <nav class="md-nav" aria-label="register_table">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_12" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_11" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_8" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#metadata-information" class="md-nav__link">
    Metadata information
  </a>
  
    <nav class="md-nav" aria-label="Metadata information">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ancestors_of" class="md-nav__link">
    ancestors_of
  </a>
  
    <nav class="md-nav" aria-label="ancestors_of">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_13" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_12" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_9" class="md-nav__link">
    Examples
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#change-data-capture" class="md-nav__link">
    Change Data Capture
  </a>
  
    <nav class="md-nav" aria-label="Change Data Capture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create_changelog_view" class="md-nav__link">
    create_changelog_view
  </a>
  
    <nav class="md-nav" aria-label="create_changelog_view">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage_14" class="md-nav__link">
    Usage
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#output_13" class="md-nav__link">
    Output
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#examples_10" class="md-nav__link">
    Examples
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#carry-over-rows" class="md-nav__link">
    Carry-over Rows
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prepost-update-images" class="md-nav__link">
    Pre/Post Update Images
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<!--
 - Licensed to the Apache Software Foundation (ASF) under one or more
 - contributor license agreements.  See the NOTICE file distributed with
 - this work for additional information regarding copyright ownership.
 - The ASF licenses this file to You under the Apache License, Version 2.0
 - (the "License"); you may not use this file except in compliance with
 - the License.  You may obtain a copy of the License at
 -
 -   http://www.apache.org/licenses/LICENSE-2.0
 -
 - Unless required by applicable law or agreed to in writing, software
 - distributed under the License is distributed on an "AS IS" BASIS,
 - WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 - See the License for the specific language governing permissions and
 - limitations under the License.
 -->

<h1 id="spark-procedures">Spark Procedures</h1>
<p>To use Iceberg in Spark, first configure <a href="../spark-configuration/">Spark catalogs</a>. Stored procedures are only available when using <a href="../spark-configuration/#sql-extensions">Iceberg SQL extensions</a> in Spark 3.</p>
<h2 id="usage">Usage</h2>
<p>Procedures can be used from any configured Iceberg catalog with <code>CALL</code>. All procedures are in the namespace <code>system</code>.</p>
<p><code>CALL</code> supports passing arguments by name (recommended) or by position. Mixing position and named arguments is not supported.</p>
<h3 id="named-arguments">Named arguments</h3>
<p>All procedure arguments are named. When passing arguments by name, arguments can be in any order and any optional argument can be omitted.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">procedure_name</span><span class="p">(</span><span class="n">arg_name_2</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">arg_2</span><span class="p">,</span><span class="w"> </span><span class="n">arg_name_1</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">arg_1</span><span class="p">)</span>
</code></pre></div>
<h3 id="positional-arguments">Positional arguments</h3>
<p>When passing arguments by position, only the ending arguments may be omitted if they are optional.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">procedure_name</span><span class="p">(</span><span class="n">arg_1</span><span class="p">,</span><span class="w"> </span><span class="n">arg_2</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="n">arg_n</span><span class="p">)</span>
</code></pre></div>
<h2 id="snapshot-management">Snapshot management</h2>
<h3 id="rollback_to_snapshot"><code>rollback_to_snapshot</code></h3>
<p>Roll back a table to a specific snapshot ID.</p>
<p>To roll back to a specific time, use <a href="#rollback_to_timestamp"><code>rollback_to_timestamp</code></a>.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This procedure invalidates all cached Spark plans that reference the affected table.</p>
</div>
<h4 id="usage_1">Usage</h4>
<table>
<thead>
<tr>
<th>Argument Name</th>
<th>Required?</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td>✔️</td>
<td>string</td>
<td>Name of the table to update</td>
</tr>
<tr>
<td><code>snapshot_id</code></td>
<td>✔️</td>
<td>long</td>
<td>Snapshot ID to rollback to</td>
</tr>
</tbody>
</table>
<h4 id="output">Output</h4>
<table>
<thead>
<tr>
<th>Output Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>previous_snapshot_id</code></td>
<td>long</td>
<td>The current snapshot ID before the rollback</td>
</tr>
<tr>
<td><code>current_snapshot_id</code></td>
<td>long</td>
<td>The new current snapshot ID</td>
</tr>
</tbody>
</table>
<h4 id="example">Example</h4>
<p>Roll back table <code>db.sample</code> to snapshot ID <code>1</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">rollback_to_snapshot</span><span class="p">(</span><span class="s1">&#39;db.sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>
<h3 id="rollback_to_timestamp"><code>rollback_to_timestamp</code></h3>
<p>Roll back a table to the snapshot that was current at some time.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This procedure invalidates all cached Spark plans that reference the affected table.</p>
</div>
<h4 id="usage_2">Usage</h4>
<table>
<thead>
<tr>
<th>Argument Name</th>
<th>Required?</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td>✔️</td>
<td>string</td>
<td>Name of the table to update</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td>✔️</td>
<td>timestamp</td>
<td>A timestamp to rollback to</td>
</tr>
</tbody>
</table>
<h4 id="output_1">Output</h4>
<table>
<thead>
<tr>
<th>Output Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>previous_snapshot_id</code></td>
<td>long</td>
<td>The current snapshot ID before the rollback</td>
</tr>
<tr>
<td><code>current_snapshot_id</code></td>
<td>long</td>
<td>The new current snapshot ID</td>
</tr>
</tbody>
</table>
<h4 id="example_1">Example</h4>
<p>Roll back <code>db.sample</code> to a specific day and time.
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">rollback_to_timestamp</span><span class="p">(</span><span class="s1">&#39;db.sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2021-06-30 00:00:00.000&#39;</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="set_current_snapshot"><code>set_current_snapshot</code></h3>
<p>Sets the current snapshot ID for a table.</p>
<p>Unlike rollback, the snapshot is not required to be an ancestor of the current table state.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This procedure invalidates all cached Spark plans that reference the affected table.</p>
</div>
<h4 id="usage_3">Usage</h4>
<table>
<thead>
<tr>
<th>Argument Name</th>
<th>Required?</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td>✔️</td>
<td>string</td>
<td>Name of the table to update</td>
</tr>
<tr>
<td><code>snapshot_id</code></td>
<td>✔️</td>
<td>long</td>
<td>Snapshot ID to set as current</td>
</tr>
</tbody>
</table>
<h4 id="output_2">Output</h4>
<table>
<thead>
<tr>
<th>Output Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>previous_snapshot_id</code></td>
<td>long</td>
<td>The current snapshot ID before the rollback</td>
</tr>
<tr>
<td><code>current_snapshot_id</code></td>
<td>long</td>
<td>The new current snapshot ID</td>
</tr>
</tbody>
</table>
<h4 id="example_2">Example</h4>
<p>Set the current snapshot for <code>db.sample</code> to 1:
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">set_current_snapshot</span><span class="p">(</span><span class="s1">&#39;db.sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="cherrypick_snapshot"><code>cherrypick_snapshot</code></h3>
<p>Cherry-picks changes from a snapshot into the current table state.</p>
<p>Cherry-picking creates a new snapshot from an existing snapshot without altering or removing the original.</p>
<p>Only append and dynamic overwrite snapshots can be cherry-picked.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This procedure invalidates all cached Spark plans that reference the affected table.</p>
</div>
<h4 id="usage_4">Usage</h4>
<table>
<thead>
<tr>
<th>Argument Name</th>
<th>Required?</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td>✔️</td>
<td>string</td>
<td>Name of the table to update</td>
</tr>
<tr>
<td><code>snapshot_id</code></td>
<td>✔️</td>
<td>long</td>
<td>The snapshot ID to cherry-pick</td>
</tr>
</tbody>
</table>
<h4 id="output_3">Output</h4>
<table>
<thead>
<tr>
<th>Output Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>source_snapshot_id</code></td>
<td>long</td>
<td>The table's current snapshot before the cherry-pick</td>
</tr>
<tr>
<td><code>current_snapshot_id</code></td>
<td>long</td>
<td>The snapshot ID created by applying the cherry-pick</td>
</tr>
</tbody>
</table>
<h4 id="examples">Examples</h4>
<p>Cherry-pick snapshot 1
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">cherrypick_snapshot</span><span class="p">(</span><span class="s1">&#39;my_table&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></p>
<p>Cherry-pick snapshot 1 with named args
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">cherrypick_snapshot</span><span class="p">(</span><span class="n">snapshot_id</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;my_table&#39;</span><span class="w"> </span><span class="p">)</span>
</code></pre></div></p>
<h2 id="metadata-management">Metadata management</h2>
<p>Many <a href="../maintenance/">maintenance actions</a> can be performed using Iceberg stored procedures.</p>
<h3 id="expire_snapshots"><code>expire_snapshots</code></h3>
<p>Each write/update/delete/upsert/compaction in Iceberg produces a new snapshot while keeping the old data and metadata
around for snapshot isolation and time travel. The <code>expire_snapshots</code> procedure can be used to remove older snapshots
and their files which are no longer needed.</p>
<p>This procedure will remove old snapshots and data files which are uniquely required by those old snapshots. This means
the <code>expire_snapshots</code> procedure will never remove files which are still required by a non-expired snapshot.</p>
<h4 id="usage_5">Usage</h4>
<table>
<thead>
<tr>
<th>Argument Name</th>
<th>Required?</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td>✔️</td>
<td>string</td>
<td>Name of the table to update</td>
</tr>
<tr>
<td><code>older_than</code></td>
<td>️</td>
<td>timestamp</td>
<td>Timestamp before which snapshots will be removed (Default: 5 days ago)</td>
</tr>
<tr>
<td><code>retain_last</code></td>
<td></td>
<td>int</td>
<td>Number of ancestor snapshots to preserve regardless of <code>older_than</code> (defaults to 1)</td>
</tr>
<tr>
<td><code>max_concurrent_deletes</code></td>
<td></td>
<td>int</td>
<td>Size of the thread pool used for delete file actions (by default, no thread pool is used)</td>
</tr>
<tr>
<td><code>stream_results</code></td>
<td></td>
<td>boolean</td>
<td>When true, deletion files will be sent to Spark driver by RDD partition (by default, all the files will be sent to Spark driver). This option is recommended to set to <code>true</code> to prevent Spark driver OOM from large file size</td>
</tr>
<tr>
<td><code>snapshot_ids</code></td>
<td></td>
<td>array of long</td>
<td>Array of snapshot IDs to expire.</td>
</tr>
</tbody>
</table>
<p>If <code>older_than</code> and <code>retain_last</code> are omitted, the table's <a href="../configuration/#table-behavior-properties">expiration properties</a> will be used.</p>
<h4 id="output_4">Output</h4>
<table>
<thead>
<tr>
<th>Output Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>deleted_data_files_count</code></td>
<td>long</td>
<td>Number of data files deleted by this operation</td>
</tr>
<tr>
<td><code>deleted_position_delete_files_count</code></td>
<td>long</td>
<td>Number of position delete files deleted by this operation</td>
</tr>
<tr>
<td><code>deleted_equality_delete_files_count</code></td>
<td>long</td>
<td>Number of equality delete files deleted by this operation</td>
</tr>
<tr>
<td><code>deleted_manifest_files_count</code></td>
<td>long</td>
<td>Number of manifest files deleted by this operation</td>
</tr>
<tr>
<td><code>deleted_manifest_lists_count</code></td>
<td>long</td>
<td>Number of manifest List files deleted by this operation</td>
</tr>
</tbody>
</table>
<h4 id="examples_1">Examples</h4>
<p>Remove snapshots older than specific day and time, but retain the last 100 snapshots:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">CALL</span><span class="w"> </span><span class="n">hive_prod</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">expire_snapshots</span><span class="p">(</span><span class="s1">&#39;db.sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="s1">&#39;2021-06-30 00:00:00.000&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">)</span>
</code></pre></div>
<p>Remove snapshots with snapshot ID <code>123</code> (note that this snapshot ID should not be the current snapshot):</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">CALL</span><span class="w"> </span><span class="n">hive_prod</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">expire_snapshots</span><span class="p">(</span><span class="k">table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db.sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">snapshot_ids</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">ARRAY</span><span class="p">(</span><span class="mi">123</span><span class="p">))</span>
</code></pre></div>
<h3 id="remove_orphan_files"><code>remove_orphan_files</code></h3>
<p>Used to remove files which are not referenced in any metadata files of an Iceberg table and can thus be considered "orphaned".</p>
<h4 id="usage_6">Usage</h4>
<table>
<thead>
<tr>
<th>Argument Name</th>
<th>Required?</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td>✔️</td>
<td>string</td>
<td>Name of the table to clean</td>
</tr>
<tr>
<td><code>older_than</code></td>
<td>️</td>
<td>timestamp</td>
<td>Remove orphan files created before this timestamp (Defaults to 3 days ago)</td>
</tr>
<tr>
<td><code>location</code></td>
<td></td>
<td>string</td>
<td>Directory to look for files in (defaults to the table's location)</td>
</tr>
<tr>
<td><code>dry_run</code></td>
<td></td>
<td>boolean</td>
<td>When true, don't actually remove files (defaults to false)</td>
</tr>
<tr>
<td><code>max_concurrent_deletes</code></td>
<td></td>
<td>int</td>
<td>Size of the thread pool used for delete file actions (by default, no thread pool is used)</td>
</tr>
</tbody>
</table>
<h4 id="output_5">Output</h4>
<table>
<thead>
<tr>
<th>Output Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>orphan_file_location</code></td>
<td>String</td>
<td>The path to each file determined to be an orphan by this command</td>
</tr>
</tbody>
</table>
<h4 id="examples_2">Examples</h4>
<p>List all the files that are candidates for removal by performing a dry run of the <code>remove_orphan_files</code> command on this table without actually removing them:
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">remove_orphan_files</span><span class="p">(</span><span class="k">table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db.sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">dry_run</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">true</span><span class="p">)</span>
</code></pre></div></p>
<p>Remove any files in the <code>tablelocation/data</code> folder which are not known to the table <code>db.sample</code>.
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">remove_orphan_files</span><span class="p">(</span><span class="k">table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db.sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">location</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;tablelocation/data&#39;</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="rewrite_data_files"><code>rewrite_data_files</code></h3>
<p>Iceberg tracks each data file in a table. More data files leads to more metadata stored in manifest files, and small data files causes an unnecessary amount of metadata and less efficient queries from file open costs.</p>
<p>Iceberg can compact data files in parallel using Spark with the <code>rewriteDataFiles</code> action. This will combine small files into larger files to reduce metadata overhead and runtime file open cost.</p>
<h4 id="usage_7">Usage</h4>
<table>
<thead>
<tr>
<th>Argument Name</th>
<th>Required?</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td>✔️</td>
<td>string</td>
<td>Name of the table to update</td>
</tr>
<tr>
<td><code>strategy</code></td>
<td></td>
<td>string</td>
<td>Name of the strategy - binpack or sort. Defaults to binpack strategy</td>
</tr>
<tr>
<td><code>sort_order</code></td>
<td></td>
<td>string</td>
<td>For Zorder use a comma separated list of columns within zorder(). (Supported in Spark 3.2 and Above) Example: zorder(c1,c2,c3). <br/>Else, Comma separated sort orders in the format (ColumnName SortDirection NullOrder). <br/>Where SortDirection can be ASC or DESC. NullOrder can be NULLS FIRST or NULLS LAST. <br/>Defaults to the table's sort order</td>
</tr>
<tr>
<td><code>options</code></td>
<td>️</td>
<td>map<string, string></td>
<td>Options to be used for actions</td>
</tr>
<tr>
<td><code>where</code></td>
<td>️</td>
<td>string</td>
<td>predicate as a string used for filtering the files. Note that all files that may contain data matching the filter will be selected for rewriting</td>
</tr>
</tbody>
</table>
<p>See the <a href="../../javadoc/1.3.1/org/apache/iceberg/actions/RewriteDataFiles.html#field.summary"><code>RewriteDataFiles</code> Javadoc</a>,
<br/>  <a href="../../javadoc/1.3.1/org/apache/iceberg/actions/BinPackStrategy.html#field.summary"><code>BinPackStrategy</code> Javadoc</a>
and <br/> <a href="../../javadoc/1.3.1/org/apache/iceberg/actions/SortStrategy.html#field.summary"><code>SortStrategy</code> Javadoc</a>
for list of all the supported options for this action.</p>
<h4 id="output_6">Output</h4>
<table>
<thead>
<tr>
<th>Output Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>rewritten_data_files_count</code></td>
<td>int</td>
<td>Number of data which were re-written by this command</td>
</tr>
<tr>
<td><code>added_data_files_count</code></td>
<td>int</td>
<td>Number of new data files which were written by this command</td>
</tr>
</tbody>
</table>
<h4 id="examples_3">Examples</h4>
<p>Rewrite the data files in table <code>db.sample</code> using the default rewrite algorithm of bin-packing to combine small files 
and also split large files according to the default write size of the table.
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">rewrite_data_files</span><span class="p">(</span><span class="s1">&#39;db.sample&#39;</span><span class="p">)</span>
</code></pre></div></p>
<p>Rewrite the data files in table <code>db.sample</code> by sorting all the data on id and name 
using the same defaults as bin-pack to determine which files to rewrite.
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">rewrite_data_files</span><span class="p">(</span><span class="k">table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db.sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">strategy</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;sort&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">sort_order</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;id DESC NULLS LAST,name ASC NULLS FIRST&#39;</span><span class="p">)</span>
</code></pre></div></p>
<p>Rewrite the data files in table <code>db.sample</code> by zOrdering on column c1 and c2.
Using the same defaults as bin-pack to determine which files to rewrite.
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">rewrite_data_files</span><span class="p">(</span><span class="k">table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db.sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">strategy</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;sort&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">sort_order</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;zorder(c1,c2)&#39;</span><span class="p">)</span>
</code></pre></div></p>
<p>Rewrite the data files in table <code>db.sample</code> using bin-pack strategy in any partition where more than 2 or more files need to be rewritten.
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">rewrite_data_files</span><span class="p">(</span><span class="k">table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db.sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">options</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="s1">&#39;min-input-files&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">))</span>
</code></pre></div></p>
<p>Rewrite the data files in table <code>db.sample</code> and select the files that may contain data matching the filter (id = 3 and name = "foo") to be rewritten.
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">rewrite_data_files</span><span class="p">(</span><span class="k">table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db.sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;id = 3 and name = &quot;foo&quot;&#39;</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="rewrite_manifests"><code>rewrite_manifests</code></h3>
<p>Rewrite manifests for a table to optimize scan planning.</p>
<p>Data files in manifests are sorted by fields in the partition spec. This procedure runs in parallel using a Spark job.</p>
<p>See the <a href="../../javadoc/1.3.1/org/apache/iceberg/actions/RewriteManifests.html"><code>RewriteManifests</code> Javadoc</a>
to see more configuration options.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This procedure invalidates all cached Spark plans that reference the affected table.</p>
</div>
<h4 id="usage_8">Usage</h4>
<table>
<thead>
<tr>
<th>Argument Name</th>
<th>Required?</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td>✔️</td>
<td>string</td>
<td>Name of the table to update</td>
</tr>
<tr>
<td><code>use_caching</code></td>
<td>️</td>
<td>boolean</td>
<td>Use Spark caching during operation (defaults to true)</td>
</tr>
</tbody>
</table>
<h4 id="output_7">Output</h4>
<table>
<thead>
<tr>
<th>Output Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>rewritten_manifests_count</code></td>
<td>int</td>
<td>Number of manifests which were re-written by this command</td>
</tr>
<tr>
<td><code>added_mainfests_count</code></td>
<td>int</td>
<td>Number of new manifest files which were written by this command</td>
</tr>
</tbody>
</table>
<h4 id="examples_4">Examples</h4>
<p>Rewrite the manifests in table <code>db.sample</code> and align manifest files with table partitioning.
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">rewrite_manifests</span><span class="p">(</span><span class="s1">&#39;db.sample&#39;</span><span class="p">)</span>
</code></pre></div></p>
<p>Rewrite the manifests in table <code>db.sample</code> and disable the use of Spark caching. This could be done to avoid memory issues on executors.
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">rewrite_manifests</span><span class="p">(</span><span class="s1">&#39;db.sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">false</span><span class="p">)</span>
</code></pre></div></p>
<h2 id="table-migration">Table migration</h2>
<p>The <code>snapshot</code> and <code>migrate</code> procedures help test and migrate existing Hive or Spark tables to Iceberg.</p>
<h3 id="snapshot"><code>snapshot</code></h3>
<p>Create a light-weight temporary copy of a table for testing, without changing the source table.</p>
<p>The newly created table can be changed or written to without affecting the source table, but the snapshot uses the original table's data files.</p>
<p>When inserts or overwrites run on the snapshot, new files are placed in the snapshot table's location rather than the original table location.</p>
<p>When finished testing a snapshot table, clean it up by running <code>DROP TABLE</code>.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Because tables created by <code>snapshot</code> are not the sole owners of their data files, they are prohibited from
actions like <code>expire_snapshots</code> which would physically delete data files. Iceberg deletes, which only effect metadata,
are still allowed. In addition, any operations which affect the original data files will disrupt the Snapshot's 
integrity. DELETE statements executed against the original Hive table will remove original data files and the
<code>snapshot</code> table will no longer be able to access them.</p>
</div>
<p>See <a href="#migrate"><code>migrate</code></a> to replace an existing table with an Iceberg table.</p>
<h4 id="usage_9">Usage</h4>
<table>
<thead>
<tr>
<th>Argument Name</th>
<th>Required?</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>source_table</code></td>
<td>✔️</td>
<td>string</td>
<td>Name of the table to snapshot</td>
</tr>
<tr>
<td><code>table</code></td>
<td>✔️</td>
<td>string</td>
<td>Name of the new Iceberg table to create</td>
</tr>
<tr>
<td><code>location</code></td>
<td></td>
<td>string</td>
<td>Table location for the new table (delegated to the catalog by default)</td>
</tr>
<tr>
<td><code>properties</code></td>
<td>️</td>
<td>map<string, string></td>
<td>Properties to add to the newly created table</td>
</tr>
</tbody>
</table>
<h4 id="output_8">Output</h4>
<table>
<thead>
<tr>
<th>Output Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>imported_files_count</code></td>
<td>long</td>
<td>Number of files added to the new table</td>
</tr>
</tbody>
</table>
<h4 id="examples_5">Examples</h4>
<p>Make an isolated Iceberg table which references table <code>db.sample</code> named <code>db.snap</code> at the
catalog's default location for <code>db.snap</code>.
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s1">&#39;db.sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;db.snap&#39;</span><span class="p">)</span>
</code></pre></div></p>
<p>Migrate an isolated Iceberg table which references table <code>db.sample</code> named <code>db.snap</code> at
a manually specified location <code>/tmp/temptable/</code>.
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">snapshot</span><span class="p">(</span><span class="s1">&#39;db.sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;db.snap&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;/tmp/temptable/&#39;</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="migrate"><code>migrate</code></h3>
<p>Replace a table with an Iceberg table, loaded with the source's data files.</p>
<p>Table schema, partitioning, properties, and location will be copied from the source table.</p>
<p>Migrate will fail if any table partition uses an unsupported format. Supported formats are Avro, Parquet, and ORC.
Existing data files are added to the Iceberg table's metadata and can be read using a name-to-id mapping created from the original table schema.</p>
<p>To leave the original table intact while testing, use <a href="#snapshot"><code>snapshot</code></a> to create new temporary table that shares source data files and schema.</p>
<p>By default, the original table is retained with the name <code>table_BACKUP_</code>.</p>
<h4 id="usage_10">Usage</h4>
<table>
<thead>
<tr>
<th>Argument Name</th>
<th>Required?</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td>✔️</td>
<td>string</td>
<td>Name of the table to migrate</td>
</tr>
<tr>
<td><code>properties</code></td>
<td>️</td>
<td>map<string, string></td>
<td>Properties for the new Iceberg table</td>
</tr>
<tr>
<td><code>drop_backup</code></td>
<td></td>
<td>boolean</td>
<td>When true, the original table will not be retained as backup (defaults to false)</td>
</tr>
</tbody>
</table>
<h4 id="output_9">Output</h4>
<table>
<thead>
<tr>
<th>Output Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>migrated_files_count</code></td>
<td>long</td>
<td>Number of files appended to the Iceberg table</td>
</tr>
</tbody>
</table>
<h4 id="examples_6">Examples</h4>
<p>Migrate the table <code>db.sample</code> in Spark's default catalog to an Iceberg table and add a property 'foo' set to 'bar':</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">migrate</span><span class="p">(</span><span class="s1">&#39;spark_catalog.db.sample&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;bar&#39;</span><span class="p">))</span>
</code></pre></div>
<p>Migrate <code>db.sample</code> in the current catalog to an Iceberg table without adding any additional properties:
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="k">CALL</span><span class="w"> </span><span class="k">catalog_name</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">migrate</span><span class="p">(</span><span class="s1">&#39;db.sample&#39;</span><span class="p">)</span>
</code></pre></div></p>
<h3 id="add_files"><code>add_files</code></h3>
<p>Attempts to directly add files from a Hive or file based table into a given Iceberg table. Unlike migrate or
snapshot, <code>add_files</code> can import files from a specific partition or partitions and does not create a new Iceberg table.
This command will create metadata for the new files and will not move them. This procedure will not analyze the schema 
of the files to determine if they actually match the schema of the Iceberg table. Upon completion, the Iceberg table 
will then treat these files as if they are part of the set of files  owned by Iceberg. This means any subsequent 
<code>expire_snapshot</code> calls will be able to physically delete the added files. This method should not be used if 
<code>migrate</code> or <code>snapshot</code> are possible.</p>
<h4 id="usage_11">Usage</h4>
<table>
<thead>
<tr>
<th>Argument Name</th>
<th>Required?</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td>✔️</td>
<td>string</td>
<td>Table which will have files added to</td>
</tr>
<tr>
<td><code>source_table</code></td>
<td>✔️</td>
<td>string</td>
<td>Table where files should come from, paths are also possible in the form of `file_format`.`path`</td>
</tr>
<tr>
<td><code>partition_filter</code></td>
<td>️</td>
<td>map<string, string></td>
<td>A map of partitions in the source table to import from</td>
</tr>
<tr>
<td><code>check_duplicate_files</code></td>
<td>️</td>
<td>boolean</td>
<td>Whether to prevent files existing in the table from being added (defaults to true)</td>
</tr>
</tbody>
</table>
<p>Warning : Schema is not validated, adding files with different schema to the Iceberg table will cause issues.</p>
<p>Warning : Files added by this method can be physically deleted by Iceberg operations</p>
<h4 id="output_10">Output</h4>
<table>
<thead>
<tr>
<th>Output Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>added_files_count</code></td>
<td>long</td>
<td>The number of files added by this command</td>
</tr>
<tr>
<td><code>changed_partition_count</code></td>
<td>long</td>
<td>The number of partitioned changed by this command</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>changed_partition_count will be 0 when table property <code>compatibility.snapshot-id-inheritance.enabled</code> is set to true</p>
</div>
<h4 id="examples_7">Examples</h4>
<p>Add the files from table <code>db.src_table</code>, a Hive or Spark table registered in the session Catalog, to Iceberg table
<code>db.tbl</code>. Only add files that exist within partitions where <code>part_col_1</code> is equal to <code>A</code>.
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="k">CALL</span><span class="w"> </span><span class="n">spark_catalog</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">add_files</span><span class="p">(</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="k">table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db.tbl&#39;</span><span class="p">,</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="n">source_table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db.src_tbl&#39;</span><span class="p">,</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="n">partition_filter</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="s1">&#39;part_col_1&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="p">)</span>
</code></pre></div></p>
<p>Add files from a <code>parquet</code> file based table at location <code>path/to/table</code> to the Iceberg table <code>db.tbl</code>. Add all
files regardless of what partition they belong to.
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="k">CALL</span><span class="w"> </span><span class="n">spark_catalog</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">add_files</span><span class="p">(</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">  </span><span class="k">table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db.tbl&#39;</span><span class="p">,</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">  </span><span class="n">source_table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;`parquet`.`path/to/table`&#39;</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="p">)</span>
</code></pre></div></p>
<h3 id="register_table"><code>register_table</code></h3>
<p>Creates a catalog entry for a metadata.json file which already exists but does not have a corresponding catalog identifier.</p>
<h4 id="usage_12">Usage</h4>
<table>
<thead>
<tr>
<th>Argument Name</th>
<th>Required?</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td>✔️</td>
<td>string</td>
<td>Table which is to be registered</td>
</tr>
<tr>
<td><code>metadata_file</code></td>
<td>✔️</td>
<td>string</td>
<td>Metadata file which is to be registered as a new catalog identifier</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Having the same metadata.json registered in more than one catalog can lead to missing updates, loss of data, and table corruption.
Only use this procedure when the table is no longer registered in an existing catalog, or you are moving a table between catalogs.</p>
</div>
<h4 id="output_11">Output</h4>
<table>
<thead>
<tr>
<th>Output Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>current_snapshot_id</code></td>
<td>long</td>
<td>The current snapshot ID of the newly registered Iceberg table</td>
</tr>
<tr>
<td><code>total_records_count</code></td>
<td>long</td>
<td>Total records count of the newly registered Iceberg table</td>
</tr>
<tr>
<td><code>total_data_files_count</code></td>
<td>long</td>
<td>Total data files count of the newly registered Iceberg table</td>
</tr>
</tbody>
</table>
<h4 id="examples_8">Examples</h4>
<p>Register a new table as <code>db.tbl</code> to <code>spark_catalog</code> pointing to metadata.json file <code>path/to/metadata/file.json</code>.
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="k">CALL</span><span class="w"> </span><span class="n">spark_catalog</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">register_table</span><span class="p">(</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">  </span><span class="k">table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db.tbl&#39;</span><span class="p">,</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">  </span><span class="n">metadata_file</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;path/to/metadata/file.json&#39;</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="p">)</span>
</code></pre></div></p>
<h2 id="metadata-information">Metadata information</h2>
<h3 id="ancestors_of"><code>ancestors_of</code></h3>
<p>Report the live snapshot IDs of parents of a specified snapshot</p>
<h4 id="usage_13">Usage</h4>
<table>
<thead>
<tr>
<th>Argument Name</th>
<th>Required?</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td>✔️</td>
<td>string</td>
<td>Name of the table to report live snapshot IDs</td>
</tr>
<tr>
<td><code>snapshot_id</code></td>
<td>️</td>
<td>long</td>
<td>Use a specified snapshot to get the live snapshot IDs of parents</td>
</tr>
</tbody>
</table>
<blockquote>
<p>tip : Using snapshot_id</p>
<p>Given snapshots history with roll back to B and addition of C' -&gt; D'
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>A<span class="w"> </span>-&gt;<span class="w"> </span>B<span class="w"> </span>-<span class="w"> </span>&gt;<span class="w"> </span>C<span class="w"> </span>-&gt;<span class="w"> </span>D
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">      </span><span class="se">\ </span>-&gt;<span class="w"> </span>C<span class="s1">&#39; -&gt; (D&#39;</span><span class="o">)</span>
</code></pre></div>
Not specifying the snapshot ID would return A -&gt; B -&gt; C' -&gt; D', while providing the snapshot ID of
D as an argument would return A-&gt; B -&gt; C -&gt; D</p>
</blockquote>
<h4 id="output_12">Output</h4>
<table>
<thead>
<tr>
<th>Output Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>snapshot_id</code></td>
<td>long</td>
<td>the ancestor snapshot id</td>
</tr>
<tr>
<td><code>timestamp</code></td>
<td>long</td>
<td>snapshot creation time</td>
</tr>
</tbody>
</table>
<h4 id="examples_9">Examples</h4>
<p>Get all the snapshot ancestors of current snapshots(default)
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="k">CALL</span><span class="w"> </span><span class="n">spark_catalog</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">ancestors_of</span><span class="p">(</span><span class="s1">&#39;db.tbl&#39;</span><span class="p">)</span>
</code></pre></div></p>
<p>Get all the snapshot ancestors by a particular snapshot
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="k">CALL</span><span class="w"> </span><span class="n">spark_catalog</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">ancestors_of</span><span class="p">(</span><span class="s1">&#39;db.tbl&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="k">CALL</span><span class="w"> </span><span class="n">spark_catalog</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">ancestors_of</span><span class="p">(</span><span class="n">snapshot_id</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db.tbl&#39;</span><span class="p">)</span>
</code></pre></div></p>
<h2 id="change-data-capture">Change Data Capture</h2>
<h3 id="create_changelog_view"><code>create_changelog_view</code></h3>
<p>Creates a view that contains the changes from a given table. </p>
<h4 id="usage_14">Usage</h4>
<table>
<thead>
<tr>
<th>Argument Name</th>
<th>Required?</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>table</code></td>
<td>✔️</td>
<td>string</td>
<td>Name of the source table for the changelog</td>
</tr>
<tr>
<td><code>changelog_view</code></td>
<td></td>
<td>string</td>
<td>Name of the view to create</td>
</tr>
<tr>
<td><code>options</code></td>
<td></td>
<td>map<string, string></td>
<td>A map of Spark read options to use</td>
</tr>
<tr>
<td><code>compute_updates</code></td>
<td></td>
<td>boolean</td>
<td>Whether to compute pre/post update images (see below for more information). Defaults to false.</td>
</tr>
<tr>
<td><code>identifier_columns</code></td>
<td></td>
<td>array<string></td>
<td>The list of identifier columns to compute updates. If the argument <code>compute_updates</code> is set to true and <code>identifier_columns</code> are not provided, the table’s current identifier fields will be used to compute updates.</td>
</tr>
<tr>
<td><code>remove_carryovers</code></td>
<td></td>
<td>boolean</td>
<td>Whether to remove carry-over rows (see below for more information). Defaults to true.</td>
</tr>
</tbody>
</table>
<p>Here is a list of commonly used Spark read options:
* <code>start-snapshot-id</code>: the exclusive start snapshot ID. If not provided, it reads from the table’s first snapshot inclusively. 
* <code>end-snapshot-id</code>: the inclusive end snapshot id, default to table's current snapshot.                                                                                                                                          <br />
* <code>start-timestamp</code>: the exclusive start timestamp. If not provided, it reads from the table’s first snapshot inclusively.
* <code>end-timestamp</code>: the inclusive end timestamp, default to table's current snapshot.                                                                                  </p>
<h4 id="output_13">Output</h4>
<table>
<thead>
<tr>
<th>Output Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>changelog_view</code></td>
<td>string</td>
<td>The name of the created changelog view</td>
</tr>
</tbody>
</table>
<h4 id="examples_10">Examples</h4>
<p>Create a changelog view <code>tbl_changes</code> based on the changes that happened between snapshot <code>1</code> (exclusive) and <code>2</code> (inclusive).
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="k">CALL</span><span class="w"> </span><span class="n">spark_catalog</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">create_changelog_view</span><span class="p">(</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="w">  </span><span class="k">table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db.tbl&#39;</span><span class="p">,</span>
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="w">  </span><span class="k">options</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="s1">&#39;start-snapshot-id&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;end-snapshot-id&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">)</span>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="p">)</span>
</code></pre></div></p>
<p>Create a changelog view <code>my_changelog_view</code> based on the changes that happened between timestamp <code>1678335750489</code> (exclusive) and <code>1678992105265</code> (inclusive).
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="k">CALL</span><span class="w"> </span><span class="n">spark_catalog</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">create_changelog_view</span><span class="p">(</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">  </span><span class="k">table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db.tbl&#39;</span><span class="p">,</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="w">  </span><span class="k">options</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="s1">&#39;start-timestamp&#39;</span><span class="p">,</span><span class="s1">&#39;1678335750489&#39;</span><span class="p">,</span><span class="s1">&#39;end-timestamp&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;1678992105265&#39;</span><span class="p">),</span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="w">  </span><span class="n">changelog_view</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;my_changelog_view&#39;</span>
<a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="p">)</span>
</code></pre></div></p>
<p>Create a changelog view that computes updates based on the identifier columns <code>id</code> and <code>name</code>.
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="k">CALL</span><span class="w"> </span><span class="n">spark_catalog</span><span class="p">.</span><span class="k">system</span><span class="p">.</span><span class="n">create_changelog_view</span><span class="p">(</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="w">  </span><span class="k">table</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="s1">&#39;db.tbl&#39;</span><span class="p">,</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="w">  </span><span class="k">options</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="k">map</span><span class="p">(</span><span class="s1">&#39;start-snapshot-id&#39;</span><span class="p">,</span><span class="s1">&#39;1&#39;</span><span class="p">,</span><span class="s1">&#39;end-snapshot-id&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2&#39;</span><span class="p">),</span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="w">  </span><span class="n">identifier_columns</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="nb">array</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
<a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="p">)</span>
</code></pre></div></p>
<p>Once the changelog view is created, you can query the view to see the changes that happened between the snapshots.
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">tbl_changes</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">tbl_changes</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">_change_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;INSERT&#39;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">_change_ordinal</span>
</code></pre></div>
Please note that the changelog view includes Change Data Capture(CDC) metadata columns
that provide additional information about the changes being tracked. These columns are:
- <code>_change_type</code>: the type of change. It has one of the following values: <code>INSERT</code>, <code>DELETE</code>, <code>UPDATE_BEFORE</code>, or <code>UPDATE_AFTER</code>.
- <code>_change_ordinal</code>: the order of changes
- <code>_commit_snapshot_id</code>: the snapshot ID where the change occurred</p>
<p>Here is an example of corresponding results. It shows that the first snapshot inserted 2 records, and the
second snapshot deleted 1 record. </p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>_change_type</th>
<th>_change_ordinal</th>
<th>_change_snapshot_id</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Alice</td>
<td>INSERT</td>
<td>0</td>
<td>5390529835796506035</td>
</tr>
<tr>
<td>2</td>
<td>Bob</td>
<td>INSERT</td>
<td>0</td>
<td>5390529835796506035</td>
</tr>
<tr>
<td>1</td>
<td>Alice</td>
<td>DELETE</td>
<td>1</td>
<td>8764748981452218370</td>
</tr>
</tbody>
</table>
<h4 id="carry-over-rows">Carry-over Rows</h4>
<p>The procedure removes the carry-over rows by default. Carry-over rows are the result of row-level operations(<code>MERGE</code>, <code>UPDATE</code> and <code>DELETE</code>)
when using copy-on-write. For example, given a file which contains row1 <code>(id=1, name='Alice')</code> and row2 <code>(id=2, name='Bob')</code>.
A copy-on-write delete of row2 would require erasing this file and preserving row1 in a new file. The changelog table
reports this as the following pair of rows, despite it not being an actual change to the table.</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>_change_type</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>Alice</td>
<td>DELETE</td>
</tr>
<tr>
<td>1</td>
<td>Alice</td>
<td>INSERT</td>
</tr>
</tbody>
</table>
<p>By default, this view finds the carry-over rows and removes them from the result. User can disable this
behavior by setting the <code>remove_carryovers</code> option to <code>false</code>.</p>
<h4 id="prepost-update-images">Pre/Post Update Images</h4>
<p>The procedure computes the pre/post update images if configured. Pre/post update images are converted from a
pair of a delete row and an insert row. Identifier columns are used for determining whether an insert and a delete record
refer to the same row. If the two records share the same values for the identity columns they are considered to be before
and after states of the same row. You can either set identifier fields in the table schema or input them as the procedure parameters.</p>
<p>The following example shows pre/post update images computation with an identifier column(<code>id</code>), where a row deletion
and an insertion with the same <code>id</code> are treated as a single update operation. Specifically, suppose we have the following pair of rows:</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>_change_type</th>
</tr>
</thead>
<tbody>
<tr>
<td>3</td>
<td>Robert</td>
<td>DELETE</td>
</tr>
<tr>
<td>3</td>
<td>Dan</td>
<td>INSERT</td>
</tr>
</tbody>
</table>
<p>In this case, the procedure marks the row before the update as an <code>UPDATE_BEFORE</code> image and the row after the update
as an <code>UPDATE_AFTER</code> image, resulting in the following pre/post update images:</p>
<table>
<thead>
<tr>
<th>id</th>
<th>name</th>
<th>_change_type</th>
</tr>
</thead>
<tbody>
<tr>
<td>3</td>
<td>Robert</td>
<td>UPDATE_BEFORE</td>
</tr>
<tr>
<td>3</td>
<td>Dan</td>
<td>UPDATE_AFTER</td>
</tr>
</tbody>
</table>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Apache Iceberg, Iceberg, Apache, the Apache feather logo, and the Apache Iceberg project logo are</br>either registered trademarks or trademarks of The Apache Software Foundation. Copyright &copy; 2023</br>The Apache Software Foundation, Licensed under the <a href="https://www.apache.org/licenses/">Apache License, Version 2.0</a>.</br></br>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.path", "navigation.top", "navigation.tracking", "toc.follow", "search.suggest", "search.highlight", "content.tabs.link", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.74e28a9f.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.220ee61c.min.js"></script>
      
    
  </body>
</html>